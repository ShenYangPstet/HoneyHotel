(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a4728708"],{"09f4":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,r,a){return e/=a/2,e<1?r/2*e*e+t:(e--,-r/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function l(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,r){var o=n(),i=e-o,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var n=Math.easeInOutQuad(c,o,i,t);l(n),c<t?a(e):r&&"function"===typeof r&&r()};u()}},"0c6f":function(e,t,r){"use strict";r.d(t,"f",(function(){return l})),r.d(t,"e",(function(){return n})),r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c}));var a=r("b775");function l(e){return Object(a["a"])({url:"zsqy/pic/".concat(e,"/findAllPicNameid"),method:"get"})}function n(e){return Object(a["a"])({url:"zsqy/Drtypeinfo/".concat(e,"/findAllDrtypeAndDr"),method:"get",params:{iscustomType:0}})}function o(e,t,r){return Object(a["a"])({url:"zsqy/Drtypeinfo/".concat(e,"/findDrinfoByType"),method:"get",params:{drtypeid:t,drname:r}})}function i(e,t){return Object(a["a"])({url:"zsqy/reg/".concat(e,"/findAllByDrid"),method:"get",params:{drid:t}})}function s(e){return Object(a["a"])({url:"zsqy/energyinfo/".concat(e,"/findAllEnergyinfo"),method:"get"})}function c(e){return Object(a["a"])({url:"zsqy/QsLdRw/".concat(e,"/findAll"),method:"get"})}},"0cd8":function(e,t,r){},4424:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"setup"},[r("div",{staticClass:"lay"},[r("div",{staticClass:"lay-left"},[e._m(0),e._v(" "),r("div",{staticClass:"admin-tablebox"},[r("div",{staticClass:"treebox"},[r("el-tree",{staticClass:"admin-tree",attrs:{data:e.deviceTypeTree,props:e.deviceTypeProps},on:{"node-click":e.selectDeviceType}}),e._v(" "),r("el-tree",{staticClass:"admin-tree",attrs:{data:e.deviceTree,props:e.deviceProps},on:{"node-click":e.selectDevice}})],1)])]),e._v(" "),r("div",{staticClass:"lay-right"},[r("div",{staticClass:"admin-header"},[e._m(1),e._v(" "),r("div",{staticClass:"admin-header-right"},[r("el-button",{staticClass:"headermr",attrs:{type:"primary"},on:{click:e.handelAdd}},[e._v("\n            增加\n          ")]),e._v(" "),r("el-button",{staticClass:"headermr",attrs:{type:"primary"},on:{click:e.exportVar}},[e._v("\n            变量导出\n          ")]),e._v(" "),r("ExcelUpload",{staticClass:"headermr",attrs:{btnName:e.btnName},on:{excelUpload:e.uploadFile}}),e._v(" "),r("el-button",{staticClass:"headermr",attrs:{type:"primary"},on:{click:e.exportVarModel}},[e._v("\n            导出变量寄存器模板\n          ")]),e._v(" "),r("el-button",{staticClass:"headermr",attrs:{type:"primary"},on:{click:e.exportAlarm}},[e._v("\n            导出变量报警\n          ")]),e._v(" "),r("ExcelUpload",{staticClass:"headermr",attrs:{btnName:"导入变量报警"},on:{excelUpload:e.uploadAlarmFile}}),e._v(" "),r("el-button",{staticClass:"headermr",attrs:{type:"danger"},on:{click:e.handelDeletes}},[e._v("\n            批量删除\n          ")])],1)]),e._v(" "),r("div",{staticClass:"admin-tablebox"},[r("el-table",{staticClass:"admin-tree maxtable",attrs:{data:e.tableDatas,border:""},on:{"selection-change":e.selectVars}},[r("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),r("af-table-column",{attrs:{prop:"regId",label:"序号"}}),e._v(" "),r("af-table-column",{attrs:{prop:"drname",label:"设备名"}}),e._v(" "),r("af-table-column",{attrs:{prop:"regName",label:"变量名"}}),e._v(" "),r("af-table-column",{attrs:{prop:"regType",label:"变量类型"}}),e._v(" "),r("af-table-column",{attrs:{prop:"regListShowLevel",label:"列表顺序"}}),e._v(" "),r("af-table-column",{attrs:{prop:"regUnits",label:"单位"}}),e._v(" "),r("af-table-column",{attrs:{prop:"tagValue",label:"初始值"}}),e._v(" "),r("af-table-column",{attrs:{prop:"tagTime",label:"采集周期"}}),e._v(" "),r("af-table-column",{attrs:{prop:"tagName",label:"寄存器"}}),e._v(" "),r("af-table-column",{attrs:{prop:"isenergy",label:"能源记录"}}),e._v(" "),r("af-table-column",{attrs:{prop:"isalarm",label:"是否报警"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(r){return e.handelEdit(t.$index,t.row)}}},[e._v("\n                编辑\n              ")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return e.handelDelete(t.$index,t.row)}}},[e._v("\n                删除\n              ")])]}}])})],1),e._v(" "),r("pages-pagination",{directives:[{name:"show",rawName:"v-show",value:e.filterObj.rowCount>0,expression:"filterObj.rowCount > 0"}],staticClass:"admin-pagination",attrs:{total:e.filterObj.rowCount,page:e.filterObj.pageCurrent,limit:e.filterObj.pageSize},on:{"update:page":function(t){return e.$set(e.filterObj,"pageCurrent",t)},"update:limit":function(t){return e.$set(e.filterObj,"pageSize",t)},pagination:e.getList}})],1)])]),e._v(" "),r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.addDialogFormVisible,width:"60%",center:""},on:{"update:visible":function(t){e.addDialogFormVisible=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,inline:!0,rules:e.rules,"label-position":"left","label-width":"99px"}},[r("el-form-item",{attrs:{label:"设备名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.drname,callback:function(t){e.$set(e.ruleForm,"drname",t)},expression:"ruleForm.drname"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"设备类型"}},[r("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.drtypename,callback:function(t){e.$set(e.ruleForm,"drtypename",t)},expression:"ruleForm.drtypename"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"显示顺序",prop:"regListShowLevel"}},[r("el-input",{attrs:{placeholder:"请输入显示顺序"},model:{value:e.ruleForm.regListShowLevel,callback:function(t){e.$set(e.ruleForm,"regListShowLevel",t)},expression:"ruleForm.regListShowLevel"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"参数名",prop:"regName"}},[r("el-input",{attrs:{placeholder:"请输入参数名"},model:{value:e.ruleForm.regName,callback:function(t){e.$set(e.ruleForm,"regName",t)},expression:"ruleForm.regName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"参数类型",prop:"regType"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择参数类型"},model:{value:e.ruleForm.regType,callback:function(t){e.$set(e.ruleForm,"regType",t)},expression:"ruleForm.regType"}},e._l(e.paramType,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"读写属性",prop:"regReadWrite"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择读写属性"},model:{value:e.ruleForm.regReadWrite,callback:function(t){e.$set(e.ruleForm,"regReadWrite",t)},expression:"ruleForm.regReadWrite"}},e._l(e.ReadAndWrite,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"初始值"}},[r("el-input",{attrs:{placeholder:"请输入初始值"},model:{value:e.ruleForm.tagValue,callback:function(t){e.$set(e.ruleForm,"tagValue",t)},expression:"ruleForm.tagValue"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"寄存器"}},[r("el-input",{attrs:{placeholder:"请输入寄存器"},model:{value:e.ruleForm.tagName,callback:function(t){e.$set(e.ruleForm,"tagName",t)},expression:"ruleForm.tagName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"显示阈值"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择显示阈值"},model:{value:e.ruleForm.regSub,callback:function(t){e.$set(e.ruleForm,"regSub",t)},expression:"ruleForm.regSub"}},e._l(e.showFZ,(function(e){return r("el-option",{key:e.value,attrs:{label:e.subname,value:e.subid}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"设备属性"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择设备属性"},model:{value:e.ruleForm.regDrShowType,callback:function(t){e.$set(e.ruleForm,"regDrShowType",t)},expression:"ruleForm.regDrShowType"}},e._l(e.regDrShowTypelist,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"存储周期"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择存储周期"},model:{value:e.ruleForm.tagTime,callback:function(t){e.$set(e.ruleForm,"tagTime",t)},expression:"ruleForm.tagTime"}},e._l(e.tagTime,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"单位"}},[r("el-input",{attrs:{placeholder:"请输入单位"},model:{value:e.ruleForm.regUnits,callback:function(t){e.$set(e.ruleForm,"regUnits",t)},expression:"ruleForm.regUnits"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"历史记录"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择历史记录"},model:{value:e.ruleForm.ishistory,callback:function(t){e.$set(e.ruleForm,"ishistory",t)},expression:"ruleForm.ishistory"}},e._l(e.historyRecord,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"能耗记录"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择能耗记录"},model:{value:e.ruleForm.isenergy,callback:function(t){e.$set(e.ruleForm,"isenergy",t)},expression:"ruleForm.isenergy"}},e._l(e.energyRecord,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("br"),e._v(" "),r("el-form-item",{attrs:{label:"是否报警"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择是否报警"},model:{value:e.ruleForm.isalarm,callback:function(t){e.$set(e.ruleForm,"isalarm",t)},expression:"ruleForm.isalarm"}},e._l(e.isAlarm,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.createAlarmForm}},[e._v("新建报警")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.removeAlarmForm}},[e._v("移除报警")]),e._v(" "),e._l(e.alarmForm,(function(t,a){return r("div",{key:a,staticClass:"alarmflex"},[r("el-form-item",{attrs:{label:"报警级别"+a,prop:"alarmLevel"+a}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择报警级别"},model:{value:t.alarmLevel,callback:function(r){e.$set(t,"alarmLevel",r)},expression:"item.alarmLevel"}},e._l(e.alarmLevel,(function(e){return r("el-option",{key:e.id,attrs:{label:e.alarmtypename,value:e.alarmtypelevel}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"报警类型"+a,prop:"alarmType"+a}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择报警类别"},model:{value:t.alarmtype,callback:function(r){e.$set(t,"alarmtype",r)},expression:"item.alarmtype"}},e._l(e.alarmType,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"报警条件低"+a,prop:"alarmMin"+a}},[r("el-input",{attrs:{placeholder:"请输入报警条件低"},model:{value:t.valueMin,callback:function(r){e.$set(t,"valueMin",r)},expression:"item.valueMin"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"报警条件高"+a,prop:"alarmMax"+a}},[r("el-input",{attrs:{placeholder:"请输入报警条件高"},model:{value:t.valueMax,callback:function(r){e.$set(t,"valueMax",r)},expression:"item.valueMax"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"条件与或"+a,prop:"alarmOrNot"+a}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择条件与或"},model:{value:t.andOr,callback:function(r){e.$set(t,"andOr",r)},expression:"item.andOr"}},e._l(e.AndOr,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"报警描述"+a,prop:"alarmexplain"+a}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入报警描述"},model:{value:t.alarmexplain,callback:function(r){e.$set(t,"alarmexplain",r)},expression:"item.alarmexplain"}})],1)],1)}))],2),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.closeFormVisible}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addTrue}},[e._v("确 定")])],1)],1)],1)},l=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"admin-header"},[r("div",{staticClass:"admin-header-left"},[r("div",{staticClass:"admin-header-left-tit"},[e._v("设备信息")])]),e._v(" "),r("div",{staticClass:"admin-header-right"})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"admin-header-left"},[r("div",{staticClass:"admin-header-left-tit"},[e._v("信息记录")])])}],n=(r("8e6e"),r("456d"),r("ac6a"),r("ade3")),o=r("2f62"),i=r("b775");function s(e){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/exportQstag"),method:"get",responseType:"blob"})}function c(e){return Object(i["a"])({url:"zsqy/regalarminfo/".concat(e,"/export"),method:"get",responseType:"blob"})}function u(e,t){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/export"),method:"get",responseType:"blob",params:{drtypeid:t}})}function d(e,t){return Object(i["a"])({url:"zsqy/regalarminfo/".concat(e,"/import"),method:"post",data:t})}function m(e,t){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/import"),method:"post",data:t})}function p(e,t){return Object(i["a"])({url:"zsqy/drinfo/".concat(e,"/findAll"),method:"get",params:{drtypeid:t}})}function g(e,t,r,a){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/findObject"),method:"get",params:{pageCurrent:t,pageSize:r,drId:a}})}function h(e){return Object(i["a"])({url:"zsqy/sub/".concat(e,"/findAll"),method:"get"})}function f(e,t){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/save"),method:"post",data:t})}function b(e,t){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/update"),method:"put",data:t})}function v(e,t){return Object(i["a"])({url:"zsqy/reg/".concat(e,"/delete"),method:"delete",params:{ids:t}})}var y=r("7bcf"),F=r("0c6f"),O=r("6c3c"),T=r("cd77"),j=r("ed08"),_=r("e4a7"),w=r("b190");function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k={components:{PagesPagination:w["a"],ExcelUpload:_["a"]},data:function(){return{selectDeviceTypedata:null,selectDevicedata:null,dialogTitle:"",regProps:{label:"regName"},alarmForm:[],regTreeData:[],regVisible:!1,AndOr:[{id:1,value:"条件与"},{id:2,value:"条件或"}],isAlarm:[{id:1,value:"报警"}],energyRecord:[{id:1,value:"能耗记录"}],historyRecord:[{id:1,value:"历史记录"}],tagTime:[{id:5,value:"每5分钟存储"},{id:10,value:"每10分钟存储"},{id:30,value:"每30分钟存储"},{id:60,value:"每60分钟存储"}],showFZ:[],alarmType:[{id:1,value:"报警"},{id:2,value:"故障"}],regDrShowTypelist:[{id:1,value:"运行状态"},{id:2,value:"运行报警"},{id:3,value:"设备故障"}],ReadAndWrite:[{id:1,value:"只读"},{id:2,value:"读写"}],paramType:[{id:1,value:"离散型"},{id:2,value:"长整型"},{id:3,value:"模拟型"},{id:4,value:"字符型"}],rules:{regName:[{required:!0,message:"参数名不能为空",trigger:"change"}],regType:[{required:!0,message:"参数类型不能为空",trigger:"change"}],regReadWrite:[{required:!0,message:"读写属性不能为空",trigger:"change"}],regListShowLevel:[{required:!0,message:"显示顺序不能为空",trigger:"change"}]},deviceTypeId:"",deviceId:"",ruleForm:{id:"",regmath:"",alarmexplain:"",andOr:"",valueMax:"",valueMin:"",alarmtype:"",alarmLevel:"",isalarm:"",isenergy:"",ishistory:"",regUnits:"",tagTime:"",regDrShowType:"",regSub:"",tagName:"",tagValue:"",regReadWrite:"",regType:"",regName:"",regListShowLevel:"",drtypename:"",drname:"",regcolor:"#FFF"},addDialogFormVisible:!1,vars:[],filterObj:{pageCurrent:1,pageCount:1,pageSize:8,rowCount:0},tableDatas:[],btnName:"变量导入",deviceProps:{label:"drname"},deviceTree:[],deviceTypeTree:[],deviceTypeProps:{children:"drtypeinfoList",label:"drtypename"}}},computed:D({},Object(o["b"])(["path"])),watch:{},methods:{closeFormVisible:function(){var e;this.addDialogFormVisible=!1,this.ruleForm=(e={id:"",regmath:"",alarmexplain:"",andOr:"",valueMax:"",valueMin:"",alarmtype:"",alarmLevel:"",isalarm:"",isenergy:"",ishistory:"",regUnits:"",tagTime:"",regDrShowType:"",regSub:"",tagName:"",tagValue:"",regReadWrite:"",regType:"",regName:"",regListShowLevel:"",drtypename:"",drname:""},Object(n["a"])(e,"regName",""),Object(n["a"])(e,"regType",""),Object(n["a"])(e,"regReadWrite",""),Object(n["a"])(e,"regListShowLevel",""),Object(n["a"])(e,"regcolor","#FFF"),e)},selectReg:function(e){this.mathContent+="@"+e.regId+"@",this.regVisible=!1},getList:function(){var e=this;g(this.path,this.filterObj.pageCurrent,this.filterObj.pageSize,this.deviceId).then((function(t){e.filterObj.rowCount=t.data.rowCount,e.tableDatas=t.data.records,e.tableDatas.forEach((function(t){t.regType=Object(O["a"])(t.regType,e.paramType),t.tagTime=Object(O["a"])(t.tagTime,e.tagTime),t.ishistory=Object(O["a"])(t.ishistory,e.historyRecord),t.isenergy=Object(O["a"])(t.isenergy,e.energyRecord),t.isalarm=Object(O["a"])(t.isalarm,e.isAlarm),t.regReadWrite=Object(O["a"])(t.regReadWrite,e.ReadAndWrite)}))})).catch(console.log)},handelDelete:function(e,t){var r=this,a=confirm("确定要批量删除变量吗？");a&&v(this.path,t.regId).then((function(e){2e4===e.status&&(r.$message.success("删除成功!"),r.getList())})).catch(console.log)},handelEdit:function(e,t){console.log(t,"row"),this.dialogTitle="修改变量",this.addDialogFormVisible=!0,this.ruleForm=t,this.ruleForm.regReadWrite=t.regReadWrite,t.regSub&&(this.ruleForm.regSub=parseInt(t.regSub)),t.regDrShowType&&(this.ruleForm.regDrShowType=parseInt(t.regDrShowType)),this.ruleForm.regType=Object(O["a"])(t.regType,this.paramType),this.ruleForm.tagTime=Object(O["a"])(t.tagTime,this.tagTime),this.ruleForm.ishistory=Object(O["a"])(t.ishistory,this.historyRecord),this.ruleForm.isenergy=Object(O["a"])(t.isenergy,this.energyRecord),this.ruleForm.isalarm=Object(O["a"])(t.isalarm,this.isAlarm),this.ruleForm.regReadWrite=Object(O["a"])(t.regReadWrite,this.ReadAndWrite),t.regalarminfoslist.forEach((function(e){e.andOr=parseInt(e.andOr),e.alarmtype=parseInt(e.alarmtype)})),this.alarmForm=t.regalarminfoslist},addTrue:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return console.log("错误提交!!"),!1;var r=new FormData;r.append("drId",e.deviceId),r.append("drtypeid",e.deviceTypeId),e.ruleForm.regDrShowType&&NaN!=e.ruleForm.regDrShowType&&r.append("regDrShowType",e.ruleForm.regDrShowType),r.append("regName",e.ruleForm.regName),r.append("regType",Object(O["c"])(e.ruleForm.regType,e.paramType)),e.ruleForm.regUnits&&r.append("regUnits",e.ruleForm.regUnits),e.ruleForm.regSub&&r.append("regSub",Object(O["c"])(e.ruleForm.regSub,e.showFZ)),r.append("regReadWrite",Object(O["c"])(e.ruleForm.regReadWrite,e.ReadAndWrite)),r.append("regListShowLevel",e.ruleForm.regListShowLevel),e.ruleForm.tagName&&r.append("tagName",e.ruleForm.tagName),e.ruleForm.tagValue&&r.append("tagValue",e.ruleForm.tagValue),e.ruleForm.tagTime&&r.append("tagTime",Object(O["c"])(e.ruleForm.tagTime,e.tagTime)),e.ruleForm.ishistory&&r.append("ishistory",Object(O["c"])(e.ruleForm.ishistory,e.historyRecord)),e.ruleForm.isenergy&&r.append("isenergy",Object(O["c"])(e.ruleForm.isenergy,e.energyRecord)),r.append("regcolor",e.ruleForm.regcolor),e.ruleForm.isalarm&&r.append("isalarm",Object(O["c"])(e.ruleForm.isalarm,e.isAlarm)),r.append("regalarminfo",JSON.stringify(e.alarmForm)),e.ruleForm.regId?(r.append("regId",e.ruleForm.regId),b(e.path,r).then((function(t){2e4===t.status&&(e.$message.success("修改成功!"),e.getList(),e.addDialogFormVisible=!1)})).catch(console.log)):f(e.path,r).then((function(t){2e4===t.status&&(e.$message.success("新增成功!"),e.getList(),e.addDialogFormVisible=!1)})).catch(console.log)}))},removeAlarmForm:function(){this.alarmForm.length>0&&this.alarmForm.pop()},createAlarmForm:function(){this.alarmForm.push({alarmLevel:"",alarmtype:"",valueMin:"",valueMax:"",andOr:"",alarmexplain:""})},selectVars:function(e){this.vars=e},handelDeletes:function(){var e=this,t=confirm("确定要批量删除变量吗？");if(t){var r=[];this.vars.forEach((function(e){r.push(e.regId)})),v(this.path,r.join(",")).then((function(t){2e4===t.status&&(e.$message.success("删除成功!"),e.getList())})).catch(console.log)}},uploadAlarmFile:function(e){var t=this,r=new FormData;r.append("file",e);var a=this.$loading({lock:!0,text:"数据正在导入数据库，请稍等",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});d(this.path,r).then((function(e){2e4===e.status&&(a.close(),t.$message.success("成功导入数据库!"),t.reload())})).catch((function(){a.close()}))},exportAlarm:function(){c(this.path).then((function(e){var t=Object(j["c"])(new Date),r="变量报警信息"+t+".xls";Object(T["a"])(e,r)})).catch(console.log)},exportVarModel:function(){s(this.path).then((function(e){var t=Object(j["c"])(new Date),r="变量寄存器模板"+t+".xls";Object(T["a"])(e,r)})).catch(console.log)},uploadFile:function(e){var t=this,r=new FormData;r.append("file",e);var a=this.$loading({lock:!0,text:"数据正在导入数据库，请稍等",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});m(this.path,r).then((function(e){2e4===e.status&&(a.close(),t.$message.success("成功导入数据库!"),t.reload())})).catch((function(){a.close()}))},exportVar:function(){u(this.path,this.deviceTypeId).then((function(e){var t=Object(j["c"])(new Date),r="变量管理"+t+".xls";Object(T["a"])(e,r)})).catch(console.log)},handelAdd:function(){""===this.ruleForm.drname?this.$message.error("增加模板前必须先选择设备！"):(this.dialogTitle="新增变量",this.addDialogFormVisible=!0,this.ruleForm.drtypename=this.selectDeviceTypedata.drtypename,this.ruleForm.drname=this.selectDevicedata.drname)},selectDevice:function(e){var t=this;this.selectDevicedata=e,this.ruleForm.drname=e.drname,this.deviceId=e.drid,this.getList(),this.regVisible&&Object(F["d"])(this.path,e.drid).then((function(e){t.regTreeData=e.data})).catch(console.log)},selectDeviceType:function(e){var t=this;this.selectDeviceTypedata=e,0===e.drtypeinfoList.length&&(this.ruleForm.drname="",this.deviceTypeId=e.drtypeid,this.ruleForm.drtypename=e.drtypename,p(this.path,e.drtypeid).then((function(e){t.deviceTree=e.data})).catch(console.log))}},created:function(){var e=this;this.getList(),Object(y["e"])(this.path).then((function(t){e.deviceTypeTree=t.data})).catch(console.log),Object(y["d"])(this.path).then((function(t){e.Component=t.data})).catch(console.log),h(this.path).then((function(t){e.showFZ=t.data})).catch(console.log),Object(y["c"])(this.path).then((function(t){e.alarmLevel=t.data})).catch(console.log)},mounted:function(){}},C=k,L=(r("456f"),r("2877")),S=Object(L["a"])(C,a,l,!1,null,"6cb6535e",null);t["default"]=S.exports},"456f":function(e,t,r){"use strict";r("0cd8")},"6c3c":function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return n}));r("ac6a");function a(e,t){var r="";return isNaN(e)||null==e||"null"==e?""!=e&&null!=e&&"null"!=e?(t.forEach((function(t){e==t.value&&(r=t.id)})),r):r:e}function l(e,t){var r="";return null!=e&&"null"!=e&&""!==e?isNaN(parseInt(e))?e:(t.forEach((function(t){parseInt(e)==t.id&&(r=t.value)})),r):r}function n(e){return null===e||"null"===e?(e="",e):e}},"7bcf":function(e,t,r){"use strict";r.d(t,"e",(function(){return l})),r.d(t,"h",(function(){return n})),r.d(t,"g",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"a",(function(){return u})),r.d(t,"i",(function(){return d})),r.d(t,"b",(function(){return m}));var a=r("b775");function l(e){return Object(a["a"])({url:"zsqy/Drtypeinfo/".concat(e,"/findAllDrtypeAndDr"),method:"get"})}function n(e,t){return Object(a["a"])({url:"zsqy/Drtypemode/".concat(e,"/export"),method:"get",responseType:"blob",params:{drtypeid:t}})}function o(e,t){return Object(a["a"])({url:"zsqy/Drtypemode/".concat(e,"/import"),method:"post",data:t})}function i(e){return Object(a["a"])({url:"zsqy/sub/".concat(e,"/findAll"),method:"get"})}function s(e){return Object(a["a"])({url:"zsqy/alarmtype/".concat(e,"/findAll"),method:"get"})}function c(e,t,r,l){return Object(a["a"])({url:"zsqy/Drtypemode/".concat(e,"/findObject"),method:"get",params:{pageCurrent:t,pageSize:r,drtypeid:l}})}function u(e,t){return Object(a["a"])({url:"zsqy/Drtypemode/".concat(e,"/save"),method:"post",data:t})}function d(e,t){return Object(a["a"])({url:"zsqy/Drtypemode/".concat(e,"/update"),method:"put",data:t})}function m(e,t){return Object(a["a"])({url:"zsqy/Drtypemode/".concat(e,"/delete"),method:"delete",params:{ids:t}})}},cd77:function(e,t,r){"use strict";function a(e,t){var r=new Blob([e]),a=document.createElement("a");a.download=t,a.style.display="none",a.href=URL.createObjectURL(r),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}r.d(t,"a",(function(){return a}))}}]);