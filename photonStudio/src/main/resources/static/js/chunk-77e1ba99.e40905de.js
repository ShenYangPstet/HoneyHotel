(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77e1ba99"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,a,i){return e/=i/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function n(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,a){var r=l(),s=e-r,o=20,c=0;t="undefined"===typeof t?500:t;var d=function e(){c+=o;var l=Math.easeInOutQuad(c,r,s,t);n(l),c<t?i(e):a&&"function"===typeof a&&a()};d()}},2731:function(e,t,a){},"4e39":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-container"},[a("div",{staticClass:"lay"},[a("div",{staticClass:"lay-left"},[e._m(0),e._v(" "),a("div",{staticClass:"admin-tablebox"},[a("el-form",{ref:"form",staticClass:"admin-form",attrs:{"label-position":"left","label-width":"130px"}},[a("el-form-item",{attrs:{label:"寄存器名称",required:""}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入寄存器名称"},model:{value:e.tagName,callback:function(t){e.tagName=t},expression:"tagName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"值类型",required:""}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择值类型"},model:{value:e.valueType,callback:function(t){e.valueType=t},expression:"valueType"}},e._l(e.valueTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"寄存器值"}},[a("el-input",{attrs:{disabled:"",placeholder:"请输入寄存器值"},model:{value:e.tagValue,callback:function(t){e.tagValue=t},expression:"tagValue"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"历史间隔时间"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择时间间隔"},model:{value:e.saveTime,callback:function(t){e.saveTime=t},expression:"saveTime"}},e._l(e.saveTimeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"设备名"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择时间间隔"},on:{change:e.changeDevice},model:{value:e.deviceAddr,callback:function(t){e.deviceAddr=t},expression:"deviceAddr"}},e._l(e.deviceAddrOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"寄存器类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择寄存器类型"},model:{value:e.tagType,callback:function(t){e.tagType=t},expression:"tagType"}},e._l(e.tagTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"寄存器地址"}},[a("el-input",{attrs:{placeholder:"请输入寄存器地址"},model:{value:e.tagAddr,callback:function(t){e.tagAddr=t},expression:"tagAddr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"设备地址"}},[a("el-input",{attrs:{placeholder:"请输入设备地址"},model:{value:e.deviceAddress,callback:function(t){e.deviceAddress=t},expression:"deviceAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"读写属性"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择读写属性"},model:{value:e.readWrite,callback:function(t){e.readWrite=t},expression:"readWrite"}},e._l(e.readWriteOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"系数"}},[a("el-input",{attrs:{placeholder:"请输入系数"},model:{value:e.ratio,callback:function(t){e.ratio=t},expression:"ratio"}})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handelAdd}},[e._v("增加")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handelUpdate}},[e._v("修改")])],1)]),e._v(" "),a("div",{staticClass:"lay-right"},[a("div",{staticClass:"admin-header"},[e._m(1),e._v(" "),a("div",{staticClass:"admin-header-right"},[a("el-input",{attrs:{clearable:"",placeholder:"请输入寄存器名"},model:{value:e.exportTagName,callback:function(t){e.exportTagName=t},expression:"exportTagName"}}),e._v(" "),a("el-button",{staticClass:"headermr",attrs:{type:"primary"},on:{click:e.searchQsTag}},[e._v("\n            查询\n          ")]),e._v(" "),a("el-button",{staticClass:"headermr",attrs:{type:"primary"},on:{click:e.exportQsTag}},[e._v("\n            寄存器导出\n          ")]),e._v(" "),a("ExcelUpload",{staticClass:"headermr",attrs:{btnName:e.btnName},on:{excelUpload:e.uploadFile}}),e._v(" "),a("el-button",{staticClass:"headermr",attrs:{type:"danger"},on:{click:e.handelDeletes}},[e._v("\n            批量删除\n          ")])],1)]),e._v(" "),a("div",{staticClass:"admin-tablebox"},[a("el-table",{staticClass:"admin-table",attrs:{data:e.tableDatas,border:""},on:{"selection-change":e.selectQsTags}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("af-table-column",{attrs:{prop:"tagid",label:"寄存器ID"}}),e._v(" "),a("af-table-column",{attrs:{prop:"tagname",label:"寄存器名称"}}),e._v(" "),a("af-table-column",{attrs:{prop:"tagvalue",label:"寄存器值"}}),e._v(" "),a("af-table-column",{attrs:{prop:"savetime",label:"转存历史间隔时间"}}),e._v(" "),a("af-table-column",{attrs:{prop:"drname",label:"设备地址"}}),e._v(" "),a("af-table-column",{attrs:{prop:"itemid",label:"寄存器地址"}}),e._v(" "),a("af-table-column",{attrs:{prop:"itemname",label:"寄存器类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handelEdit(t.$index,t.row)}}},[e._v("\n                编辑\n              ")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handelDelete(t.$index,t.row)}}},[e._v("\n                删除\n              ")])]}}])})],1),e._v(" "),a("pages-pagination",{directives:[{name:"show",rawName:"v-show",value:e.filterObj.rowCount>0,expression:"filterObj.rowCount > 0"}],staticClass:"admin-pagination",attrs:{total:e.filterObj.rowCount,page:e.filterObj.pageCurrent,limit:e.filterObj.pageSize},on:{"update:page":function(t){return e.$set(e.filterObj,"pageCurrent",t)},"update:limit":function(t){return e.$set(e.filterObj,"pageSize",t)},pagination:e.getList}})],1)])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-header"},[a("div",{staticClass:"admin-header-left"},[a("div",{staticClass:"admin-header-left-tit"},[e._v("变量寄存器编辑")])]),e._v(" "),a("div",{staticClass:"admin-header-right"})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-header-left"},[a("div",{staticClass:"admin-header-left-tit"},[e._v("变量寄存器信息")])])}],l=(a("8e6e"),a("456d"),a("a481"),a("ac6a"),a("ade3")),r=a("2f62"),s=a("b775");function o(e,t){return Object(s["a"])({url:"zsqy/qstag/".concat(e,"/export"),method:"get",params:{tagname:t},responseType:"blob"})}function c(e,t){return Object(s["a"])({url:"zsqy/qstag/".concat(e,"/import"),method:"post",data:t})}function d(e){return Object(s["a"])({url:"zsqy/dlldrinfo/".concat(e,"/findDlldrinfo"),method:"get"})}function u(e,t){return Object(s["a"])({url:"zsqy/dlldrinfo/".concat(e,"/findDrlltype"),method:"get",params:{drid:t}})}function p(e,t,a,i){return Object(s["a"])({url:"zsqy/qstag/".concat(e,"/findObject"),method:"get",params:{pageCurrent:t,pageSize:a,tagname:i}})}function m(e,t){return Object(s["a"])({url:"zsqy/qstag/".concat(e,"/save"),method:"post",data:t})}function v(e,t){return Object(s["a"])({url:"zsqy/qstag/".concat(e,"/update"),method:"put",data:t})}function h(e,t){return Object(s["a"])({url:"zsqy/qstag/".concat(e,"/delete"),method:"delete",params:{ids:t}})}var f=a("e4a7"),b=a("cd77"),g=a("ed08"),y=a("6c3c"),O=a("b190");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var j={inject:["reload"],components:{PagesPagination:O["a"],ExcelUpload:f["a"]},computed:_({},Object(r["b"])(["path"])),data:function(){return{btnName:"寄存器导入",exportTagName:"",tagName:"",valueType:1,valueTypeOptions:[{id:1,value:"离散型"},{id:2,value:"长整型"},{id:3,value:"模拟型"},{id:4,value:"字符型"}],tagValue:0,saveTime:"每5分钟存储",saveTimeOptions:[{id:5,value:"每5分钟存储"},{id:10,value:"每10分钟存储"},{id:30,value:"每30分钟存储"},{id:60,value:"每60分钟存储"}],deviceAddr:"",deviceAddrOptions:[],tagAddr:"",deviceAddress:"",readWrite:1,readWriteOptions:[{id:1,value:"只读"},{id:2,value:"读写"},{id:3,value:"只写"}],ratio:"",tagType:"",tagTypeOptions:[],qsTags:[],filterObj:{pageCurrent:1,pageCount:1,pageSize:10,rowCount:0},tableDatas:[],editData:{}}},mounted:function(){var e=this;d(this.path).then((function(t){t.data.forEach((function(t){var a={id:t.drid,value:t.drname};e.deviceAddrOptions.push(a)}))})).catch(console.log),this.getList()},methods:{searchQsTag:function(){this.filterObj.pageCurrent=1,this.getList()},getList:function(e,t,a){var i=this;p(this.path,this.filterObj.pageCurrent,this.filterObj.pageSize,this.exportTagName).then((function(e){i.filterObj.rowCount=e.data.rowCount,i.tableDatas=e.data.records,i.tableDatas.forEach((function(e){e.savetime=Object(y["a"])(e.savetime,i.saveTimeOptions)}))})).catch(console.log)},findAllDrllType:function(e){var t=this;u(this.path,e).then((function(e){e.data.forEach((function(e){var a={id:e.itemtype,value:e.itemname};t.tagTypeOptions.push(a)}))})).catch(console.log)},changeDevice:function(e){this.tagTypeOptions=[],this.tagType="",""!=e&&this.findAllDrllType(e)},handelAdd:function(){var e=this,t=new FormData;t.append("tagname",this.tagName.replace(/\s/g,"")),t.append("tagvalue",this.tagValue),t.append("savetime",Object(y["c"])(this.saveTime,this.saveTimeOptions)),t.append("itemdrid",Object(y["c"])(this.deviceAddr,this.deviceAddrOptions)),t.append("itemid",Object(y["b"])(this.tagAddr)),t.append("itemtype",Object(y["c"])(this.tagType,this.tagTypeOptions)),t.append("itemdradd",this.deviceAddress),t.append("itemreadtype",this.readWrite),t.append("valuetype",this.valueType),t.append("itemxs",this.ratio),m(this.path,t).then((function(t){2e4===t.status&&(e.$message.success("新增成功!"),e.getList())})).catch(console.log)},handelEdit:function(e,t){this.editData=t,this.tagName=t.tagname,this.tagValue=t.tagvalue,this.saveTime=t.savetime,this.deviceAddr=t.drname,this.tagAddr=t.itemid,this.tagType=t.itemname,this.deviceAddress=t.itemdradd,this.readWrite=t.itemreadtype,this.valueType=t.valuetype,this.ratio=t.itemxs,this.findAllDrllType(t.itemdrid)},handelUpdate:function(){var e=this,t=new FormData;t.append("tagid",this.editData.tagid),t.append("tagname",this.tagName.replace(/\s/g,"")),t.append("tagvalue",Object(y["b"])(this.tagValue)),t.append("savetime",Object(y["c"])(this.saveTime,this.saveTimeOptions)),t.append("itemdrid",Object(y["c"])(this.deviceAddr,this.deviceAddrOptions)),t.append("itemid",Object(y["b"])(this.tagAddr)),t.append("itemtype",Object(y["c"])(this.tagType,this.tagTypeOptions)),t.append("itemdradd",this.deviceAddress),t.append("itemreadtype",this.readWrite),t.append("valuetype",this.valueType),t.append("itemxs",this.ratio),v(this.path,t).then((function(t){2e4===t.status&&(e.$message.success("修改成功!"),e.getList())})).catch(console.log)},handelDelete:function(e,t){var a=this,i=confirm("确定要删除吗？");i&&h(this.path,t.tagid).then((function(e){2e4===e.status&&(a.$message.success("删除成功!"),a.getList())})).catch(console.log)},selectQsTags:function(e){this.qsTags=e},handelDeletes:function(){var e=this,t=confirm("确定要批量删除吗？");if(t){var a=[];this.qsTags.forEach((function(e){a.push(e.tagid)})),h(this.path,a.join(",")).then((function(t){2e4===t.status&&(e.$message.success("批量删除成功!"),e.getList())})).catch(console.log)}},uploadFile:function(e){var t=this,a=new FormData;a.append("file",e);var i=this.$loading({lock:!0,text:"数据正在导入数据库，请稍等",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});c(this.path,a).then((function(e){2e4===e.status&&(i.close(),t.$message.success("成功导入数据库!"),t.getList())})).catch(console.log)},exportQsTag:function(){o(this.path,this.exportTagName).then((function(e){var t=Object(g["c"])(new Date),a="变量寄存器信息"+t+".xls";Object(b["a"])(e,a)})).catch(console.log)}}},w=j,C=(a("5b25"),a("2877")),x=Object(C["a"])(w,i,n,!1,null,"48c6e038",null);t["default"]=x.exports},"5b25":function(e,t,a){"use strict";a("2731")},"6c3c":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return l}));a("ac6a");function i(e,t){var a="";return isNaN(e)||null==e||"null"==e?""!=e&&null!=e&&"null"!=e?(t.forEach((function(t){e==t.value&&(a=t.id)})),a):a:e}function n(e,t){var a="";return null!=e&&"null"!=e&&""!==e?isNaN(parseInt(e))?e:(t.forEach((function(t){parseInt(e)==t.id&&(a=t.value)})),a):a}function l(e){return null===e||"null"===e?(e="",e):e}},cd77:function(e,t,a){"use strict";function i(e,t){var a=new Blob([e]),i=document.createElement("a");i.download=t,i.style.display="none",i.href=URL.createObjectURL(a),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}a.d(t,"a",(function(){return i}))}}]);